#!/usr/bin/env sage
import hashlib

q = 1118817215266473099401489299835945027713635248219
a = 3437776292996777467976657547577967657547
b = 828669865469592426262363475477574643634

m1, r1, s1 = ('VolgaCTF{nKpV/dmkBeQ0n9Mz0g9eGQ==}', 1030409245884476193717141088285092765299686864672, 830067187231135666416948244755306407163838542785)
m2, r2, s2 = ('VolgaCTF{KtetaQ4YT8PhTL3O4vsfDg==}', 403903893160663712713225718481237860747338118174, 803753330562964683180744246754284061126230157465)

m1 = int(hashlib.md5(m1).hexdigest(), 16)
m2 = int(hashlib.md5(m2).hexdigest(), 16)

M = matrix(GF(q), 3, 3)
M.set_row(0, [-r1, s1, 0])
M.set_row(1, [-r2, 0, s2])
M.set_row(2, [0, -a, 1])

V = vector(GF(q), [m1, m2, b])

print hex(int((~M * V)[0]))[2:-1]
